!function(){function i(i,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}function n(n,t,o){return t&&i(n.prototype,t),o&&i(n,o),n}function t(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{RUSD:function(i,o,e){"use strict";e.r(o),e.d(o,"InscripcionesModule",function(){return R});var r,a=e("ofXK"),s=e("tyNb"),c=function i(){t(this,i)},l=e("PSD3"),u=e.n(l),h=e("fXoL"),p=e("FHRc"),f=e("AytR"),b=e("tk/3"),d=e("sSZD"),m=((r=function(){function i(n,o){var e=this;t(this,i),this.http=n,this.firebase=o,this.mats=[],this.ins=[],this.materias=this.firebase.list("materias"),this.materias.snapshotChanges().forEach(function(i){e.mats=[],i.forEach(function(i){var n=i.payload.toJSON();e.mats.push(n)})}),this.inscripciones=this.firebase.list("inscripciones"),this.inscripciones.snapshotChanges().forEach(function(i){e.ins=[],i.forEach(function(i){var n=i.payload.toJSON();n.uid=i.payload.key,e.ins.push(n)})})}return n(i,[{key:"traerTodos",value:function(){return this.materias}},{key:"traerTodosIns",value:function(){return this.inscripciones}},{key:"traerPorNombreIns",value:function(i){for(var n=null,t=0;t<this.ins.length;t++)this.ins[t].nombre==i&&(n=this.ins[t]);return n}},{key:"traerPorNombre",value:function(i){for(var n=null,t=0;t<this.mats.length;t++)this.mats[t].nombre==i&&(n=this.mats[t]);return n}},{key:"traerPorProfesor",value:function(i){for(var n=0;n<this.mats.length;n++)this.mats[n].profesor.correo==i&&null.push(this.mats[n]);return null}},{key:"validaRegistro",value:function(i,n,t){var o=!1;return this.mats.forEach(function(e){i==e.nombre&&n==e.cuatrimestre&&t==e.anio&&(o=!0)}),o}},{key:"registrarEnBD",value:function(i){return this.http.post("".concat(f.a.hostFirebase,"/materias.json"),i)}},{key:"inscribirAlumno",value:function(i){return this.http.post("".concat(f.a.hostFirebase,"/inscripciones.json"),i)}},{key:"sobrescribir",value:function(i){return this.http.patch("".concat(f.a.hostFirebase,"/inscripciones/").concat(i.uid,".json"),i)}}]),i}()).\u0275fac=function(i){return new(i||r)(h.Yb(b.a),h.Yb(d.a))},r.\u0275prov=h.Lb({token:r,factory:r.\u0275fac,providedIn:"root"}),r),g=e("JqCM"),v=e("YR4g"),y=e("6zmi"),k=e("6k2k");function w(i,n){if(1&i){var t=h.Vb();h.Ub(0,"a",13),h.bc("click",function(){h.pc(t);var i=h.dc().$implicit;return h.dc(2).mostrarAlumnos(i)}),h.wc(1,"Ver alumnos"),h.Tb()}}function x(i,n){if(1&i){var t=h.Vb();h.Ub(0,"div",5),h.Ub(1,"div",6),h.Qb(2,"img",7),h.Ub(3,"div",8),h.Ub(4,"h5",9),h.wc(5),h.ec(6,"uppercase"),h.Tb(),h.Ub(7,"p",10),h.wc(8),h.Tb(),h.Ub(9,"a",11),h.bc("click",function(){h.pc(t);var i=n.$implicit;return h.dc(2).elegirMateria(i)}),h.wc(10,"Inscribirse"),h.Tb(),h.vc(11,w,2,0,"a",12),h.Tb(),h.Tb(),h.Tb()}if(2&i){var o=n.$implicit,e=h.dc(2);h.Db(2),h.kc("src",o.foto,h.rc),h.Db(3),h.xc(h.fc(6,5,o.nombre)),h.Db(3),h.zc("",o.cuatrimestre," cuatrimestre - ",o.anio," a\xf1o"),h.Db(3),h.jc("ngIf","listados"==e.paginaActual)}}function E(i,n){if(1&i&&(h.Ub(0,"div",3),h.vc(1,x,12,7,"div",4),h.Tb()),2&i){var t=h.dc();h.Db(1),h.jc("ngForOf",t.materias)}}function T(i,n){if(1&i&&(h.Ub(0,"div",5),h.Ub(1,"div",15),h.Qb(2,"img",7),h.Ub(3,"div",8),h.Ub(4,"h5",9),h.wc(5),h.ec(6,"uppercase"),h.Tb(),h.Tb(),h.Tb(),h.Tb()),2&i){var t=n.$implicit;h.Db(2),h.kc("src",t.foto,h.rc),h.Db(3),h.xc(h.fc(6,2,t.correo))}}function P(i,n){1&i&&(h.Ub(0,"p"),h.wc(1,"No hay alumnos inscriptos."),h.Tb())}function O(i,n){if(1&i&&(h.Ub(0,"div",3),h.Ub(1,"span"),h.wc(2),h.Tb(),h.vc(3,T,7,4,"div",4),h.vc(4,P,2,0,"p",14),h.Tb()),2&i){var t=h.dc();h.Db(2),h.yc("Hay ",t.cupoDisponible," cupos disponibles."),h.Db(1),h.jc("ngForOf",t.alumnosParaMostrar),h.Db(1),h.jc("ngIf",0==t.alumnosParaMostrar.length)}}var D,M=((D=function(){function i(n,o,e){t(this,i),this.matService=n,this.spinner=o,this.storage=e,this.materiaElegidaEvent=new h.n,this.paginaActual="inscripcion",this.loading=!0,this.mostrar=!1}return n(i,[{key:"ngOnInit",value:function(){var i=this;this.spinner.show(),this.matService.traerTodos().snapshotChanges().forEach(function(n){i.materias=[],n.forEach(function(n){var t=n.payload.toJSON();t.uid=n.payload.key,t.estado==y.a.activo&&i.storage.traerFoto(t.foto).subscribe(function(n){t.foto=n,i.materias.push(t)})}),i.spinner.hide().then(function(){i.loading=!1})}),this.matService.traerTodosIns().snapshotChanges().forEach(function(n){i.inscripciones=[],n.forEach(function(n){var t=n.payload.toJSON();t.uid=n.payload.key,i.inscripciones.push(t)})})}},{key:"elegirMateria",value:function(i){this.elegida=i.nombre,this.materiaElegidaEvent.emit(i)}},{key:"mostrarAlumnos",value:function(i){var n=this;this.mostrar=!0,this.alumnosParaMostrar=[];var t=0;this.inscripciones.forEach(function(o){if(o&&o.nombre==i.nombre){n.cupoDisponible=o.cupoDisponible;for(var e=0;0==t;e++)o.alumnos[e]?n.alumnosParaMostrar.push(o.alumnos[e]):t=1}})}}]),i}()).\u0275fac=function(i){return new(i||D)(h.Pb(m),h.Pb(g.c),h.Pb(k.a))},D.\u0275cmp=h.Jb({type:D,selectors:[["app-listado-materias"]],inputs:{paginaActual:["pagina","paginaActual"]},outputs:{materiaElegidaEvent:"materiaElegidaEvent"},decls:4,vars:2,consts:[["bdColor","rgba(51,51,51,0.8)","size","large","color","#fff","type","ball-scale-multiple"],[2,"font-size","20px","color","white"],["class","listado",4,"ngIf"],[1,"listado"],["class","fila",4,"ngFor","ngForOf"],[1,"fila"],[1,"card",2,"width","300","height","300","margin","10px"],["alt","Card image cap",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"btn","btn-dark",2,"margin","2px",3,"click"],["class","btn btn-danger","style","margin: 2px;",3,"click",4,"ngIf"],[1,"btn","btn-danger",2,"margin","2px",3,"click"],[4,"ngIf"],[1,"card",2,"width","300","height","250","margin","10px"]],template:function(i,n){1&i&&(h.Ub(0,"ngx-spinner",0),h.Qb(1,"p",1),h.Tb(),h.vc(2,E,2,1,"div",2),h.vc(3,O,5,3,"div",2)),2&i&&(h.Db(2),h.jc("ngIf",!n.loading),h.Db(1),h.jc("ngIf",!n.loading&&n.mostrar))},directives:[g.a,a.k,a.j],pipes:[a.q],styles:[".listado[_ngcontent-%COMP%]{overflow-x:scroll;border-radius:3px}.fila[_ngcontent-%COMP%], .listado[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:100%}.fila[_ngcontent-%COMP%]{padding:5px;justify-content:space-between}img[_ngcontent-%COMP%]{height:200px;width:300px}"]}),D),C=e("mRib");function U(i,n){if(1&i){var t=h.Vb();h.Ub(0,"div",2),h.Ub(1,"div",3),h.bc("click",function(){h.pc(t);var i=n.$implicit;return h.dc().elegirAlumno(i)}),h.Qb(2,"img",4),h.Ub(3,"div",5),h.Ub(4,"h5",6),h.wc(5),h.Tb(),h.Tb(),h.Tb(),h.Tb()}if(2&i){var o=n.$implicit;h.Db(2),h.kc("src",o.foto,h.rc),h.Db(3),h.xc(o.correo)}}var j,S,I,A,_=((j=function(){function i(n,o,e){t(this,i),this.usService=n,this.spinner=o,this.storage=e,this.alumnoElegidoEvent=new h.n,this.loading=!0,this.mostrar=!1}return n(i,[{key:"ngOnInit",value:function(){var i=this;this.spinner.show(),this.usService.traerTodos().snapshotChanges().forEach(function(n){i.alumnos=[],n.forEach(function(n){var t=n.payload.toJSON();t.estado==y.b.activo&&t.tipo==y.c.alumno&&i.storage.traerFoto(t.foto).subscribe(function(n){t.foto=n,i.alumnos.push(t)})}),i.spinner.hide().then(function(){i.loading=!1})})}},{key:"elegirAlumno",value:function(i){this.elegida=i.correo,this.alumnoElegidoEvent.emit(i)}}]),i}()).\u0275fac=function(i){return new(i||j)(h.Pb(C.a),h.Pb(g.c),h.Pb(k.a))},j.\u0275cmp=h.Jb({type:j,selectors:[["app-listado-alumnos"]],outputs:{alumnoElegidoEvent:"alumnoElegidoEvent"},decls:2,vars:1,consts:[[1,"listado"],["class","fila",4,"ngFor","ngForOf"],[1,"fila"],[1,"card",2,"width","250","height","210","margin","10px",3,"click"],["alt","Card image cap",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"]],template:function(i,n){1&i&&(h.Ub(0,"div",0),h.vc(1,U,6,2,"div",1),h.Tb()),2&i&&(h.Db(1),h.jc("ngForOf",n.alumnos))},directives:[a.j],styles:[".listado[_ngcontent-%COMP%]{flex-direction:row;overflow-x:scroll;border-radius:3px}.fila[_ngcontent-%COMP%], .listado[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.fila[_ngcontent-%COMP%]{padding:5px;justify-content:space-between}img[_ngcontent-%COMP%]{height:170px;width:250px}.card[_ngcontent-%COMP%]{cursor:pointer}"]}),j),N=e("3Pt+"),F=[{path:"",component:(S=function(){function i(n,o,e,r){t(this,i),this.auth=n,this.matService=o,this.spinner=e,this.router=r,this.alumno=null,this.materia=null}return n(i,[{key:"ngOnInit",value:function(){}},{key:"salir",value:function(i){var n=this;this.spinner.show(),this.auth.logOut().then(function(){localStorage.removeItem("UsuarioActual"),n.spinner.hide().then(function(){n.router.navigate(["/"])})})}},{key:"asignarDatos",value:function(i,n){"materia"==n?(this.materia=i,this.nombre=this.materia.nombre):(this.alumno=i,this.correo=this.alumno.correo)}},{key:"enviarDatos",value:function(){var i=this;this.spinner.show(),null!=this.materia&&null!=this.alumno?(this.inscripcion=this.matService.traerPorNombreIns(this.materia.nombre),console.log("ESTO HAY ",this.inscripcion),null==this.inscripcion?(this.inscripcion=new c,this.inscripcion.cupo=this.materia.cupo,this.inscripcion.materia=this.materia,this.inscripcion.nombre=this.materia.nombre,this.inscripcion.cupoDisponible=this.materia.cupo-1,this.inscripcion.alumnos=this.inscripcion.alumnos||[],this.inscripcion.alumnos.push(this.alumno),this.matService.inscribirAlumno(this.inscripcion).subscribe(function(){i.spinner.hide().then(function(){u.a.fire({title:"Listo!",text:"Alumno inscripto!",icon:"success",confirmButtonText:"Ok"}).then(function(){i.materia=null,i.alumno=null})})})):(console.log(this.inscripcion),0!=this.calcularDisponibilidad(this.inscripcion)?this.yaRegistrado(this.inscripcion)?this.spinner.hide().then(function(){u.a.fire({title:"Error!",text:"Ya esta registrado en esta materia",icon:"error",confirmButtonColor:"red",confirmButtonText:"Ok"}).then(function(){i.materia=null,i.alumno=null})}):(this.inscripcion.cupoDisponible=this.inscripcion.cupoDisponible-1,this.inscripcion.alumnos=this.calcularArray(this.inscripcion),this.inscripcion.alumnos.push(this.alumno),this.matService.sobrescribir(this.inscripcion).subscribe(function(){i.spinner.hide().then(function(){u.a.fire({title:"Listo!",text:"Alumno inscripto!",icon:"success",confirmButtonText:"Ok"}).then(function(){i.materia=null,i.alumno=null})})})):this.spinner.hide().then(function(){u.a.fire({title:"Error!",text:"No hay mas cupo disponible",icon:"error",confirmButtonColor:"red",confirmButtonText:"Ok"}).then(function(){i.materia=null,i.alumno=null})}))):this.spinner.hide().then(function(){u.a.fire({title:"Error!",text:"Tenes que seleccionar una materia y un alumno",icon:"error",confirmButtonColor:"red",confirmButtonText:"Ok"}).then(function(){i.materia=null,i.alumno=null})})}},{key:"calcularDisponibilidad",value:function(i){return i.alumnos?i.cupo==i.alumnos.length?0:i.cupo-i.alumnos.length:i.cupo}},{key:"yaRegistrado",value:function(i){var n,t=0;n=this.matService.traerPorNombreIns(i.nombre),console.log("INS",n);for(var o=0;0==t;o++)if(n.alumnos[o]){if(n.alumnos[o].correo==this.alumno.correo)return!0}else t=1;return!1}},{key:"calcularArray",value:function(i){for(var n=[],t=0,o=0;0==t;o++)i.alumnos[o]?n.push(i.alumnos[o]):t=1;return console.log(n),n}}]),i}(),S.\u0275fac=function(i){return new(i||S)(h.Pb(p.a),h.Pb(m),h.Pb(g.c),h.Pb(s.b))},S.\u0275cmp=h.Jb({type:S,selectors:[["app-inscripciones"]],decls:11,vars:2,consts:[[3,"navigateEvent"],[1,"centrado"],[1,"formulario","animate__animated","animate__fadeIn"],[1,"listados"],[3,"materiaElegidaEvent"],[3,"alumnoElegidoEvent"],[1,"futer"],["type","text","disabled","","placeholder","Alumno elegido",3,"ngModel","ngModelChange"],["type","text","disabled","","placeholder","Materia elegida",3,"ngModel","ngModelChange"],[1,"btn","btn-dark",2,"width","200px",3,"click"]],template:function(i,n){1&i&&(h.Ub(0,"app-cabecera",0),h.bc("navigateEvent",function(i){return n.salir(i)}),h.Tb(),h.Ub(1,"div",1),h.Ub(2,"div",2),h.Ub(3,"div",3),h.Ub(4,"app-listado-materias",4),h.bc("materiaElegidaEvent",function(i){return n.asignarDatos(i,"materia")}),h.Tb(),h.Ub(5,"app-listado-alumnos",5),h.bc("alumnoElegidoEvent",function(i){return n.asignarDatos(i,"alumno")}),h.Tb(),h.Tb(),h.Ub(6,"div",6),h.Ub(7,"input",7),h.bc("ngModelChange",function(i){return n.correo!=i}),h.Tb(),h.Ub(8,"input",8),h.bc("ngModelChange",function(i){return n.nombre!=i}),h.Tb(),h.Ub(9,"button",9),h.bc("click",function(){return n.enviarDatos()}),h.wc(10,"Aceptar"),h.Tb(),h.Tb(),h.Tb(),h.Tb()),2&i&&(h.Db(7),h.jc("ngModel",n.correo),h.Db(1),h.jc("ngModel",n.nombre))},directives:[v.a,M,_,N.a,N.g,N.j],styles:[".centrado[_ngcontent-%COMP%]{position:absolute;width:100%;height:92%;background-size:100% 100%;background-color:bisque;overflow-y:hidden;display:flex;align-items:center;justify-content:center}.formulario[_ngcontent-%COMP%]{width:1000px;max-height:900px;padding:20px;background-color:#fff;border-radius:10px;box-shadow:0 0 10px #000;border:none;display:flex;flex-direction:column}.futer[_ngcontent-%COMP%]{padding:15px;display:flex;flex-direction:row;align-items:center;justify-content:space-around}.listados[_ngcontent-%COMP%]{width:100%;height:100%}"]}),S)}],J=((I=function i(){t(this,i)}).\u0275fac=function(i){return new(i||I)},I.\u0275mod=h.Nb({type:I}),I.\u0275inj=h.Mb({imports:[[s.c.forChild(F)],s.c]}),I),B=e("lSLK"),R=((A=function i(){t(this,i)}).\u0275fac=function(i){return new(i||A)},A.\u0275mod=h.Nb({type:A}),A.\u0275inj=h.Mb({imports:[[a.c,J,B.a,N.e]]}),A)}}])}();
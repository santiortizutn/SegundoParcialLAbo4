(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{RUSD:function(i,t,n){"use strict";n.r(t),n.d(t,"InscripcionesModule",function(){return j});var s=n("ofXK"),e=n("tyNb");class o{constructor(){}}var r=n("PSD3"),a=n.n(r),c=n("fXoL"),l=n("FHRc"),h=n("AytR"),u=n("tk/3"),p=n("sSZD");let b=(()=>{class i{constructor(i,t){this.http=i,this.firebase=t,this.mats=[],this.ins=[],this.materias=this.firebase.list("materias"),this.materias.snapshotChanges().forEach(i=>{this.mats=[],i.forEach(i=>{const t=i.payload.toJSON();this.mats.push(t)})}),this.inscripciones=this.firebase.list("inscripciones"),this.inscripciones.snapshotChanges().forEach(i=>{this.ins=[],i.forEach(i=>{const t=i.payload.toJSON();t.uid=i.payload.key,this.ins.push(t)})})}traerTodos(){return this.materias}traerTodosIns(){return this.inscripciones}traerPorNombreIns(i){let t=null;for(let n=0;n<this.ins.length;n++)this.ins[n].nombre==i&&(t=this.ins[n]);return t}traerPorNombre(i){let t=null;for(let n=0;n<this.mats.length;n++)this.mats[n].nombre==i&&(t=this.mats[n]);return t}traerPorProfesor(i){for(let t=0;t<this.mats.length;t++)this.mats[t].profesor.correo==i&&null.push(this.mats[t]);return null}validaRegistro(i,t,n){let s=!1;return this.mats.forEach(e=>{i==e.nombre&&t==e.cuatrimestre&&n==e.anio&&(s=!0)}),s}registrarEnBD(i){return this.http.post(`${h.a.hostFirebase}/materias.json`,i)}inscribirAlumno(i){return this.http.post(`${h.a.hostFirebase}/inscripciones.json`,i)}sobrescribir(i){return this.http.patch(`${h.a.hostFirebase}/inscripciones/${i.uid}.json`,i)}}return i.\u0275fac=function(t){return new(t||i)(c.Yb(u.a),c.Yb(p.a))},i.\u0275prov=c.Lb({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var d=n("JqCM"),m=n("YR4g"),g=n("6zmi"),f=n("6k2k");function v(i,t){if(1&i){const i=c.Vb();c.Ub(0,"a",13),c.bc("click",function(){c.pc(i);const t=c.dc().$implicit;return c.dc(2).mostrarAlumnos(t)}),c.wc(1,"Ver alumnos"),c.Tb()}}function x(i,t){if(1&i){const i=c.Vb();c.Ub(0,"div",5),c.Ub(1,"div",6),c.Qb(2,"img",7),c.Ub(3,"div",8),c.Ub(4,"h5",9),c.wc(5),c.ec(6,"uppercase"),c.Tb(),c.Ub(7,"p",10),c.wc(8),c.Tb(),c.Ub(9,"a",11),c.bc("click",function(){c.pc(i);const n=t.$implicit;return c.dc(2).elegirMateria(n)}),c.wc(10,"Inscribirse"),c.Tb(),c.vc(11,v,2,0,"a",12),c.Tb(),c.Tb(),c.Tb()}if(2&i){const i=t.$implicit,n=c.dc(2);c.Db(2),c.kc("src",i.foto,c.rc),c.Db(3),c.xc(c.fc(6,5,i.nombre)),c.Db(3),c.zc("",i.cuatrimestre," cuatrimestre - ",i.anio," a\xf1o"),c.Db(3),c.jc("ngIf","listados"==n.paginaActual)}}function w(i,t){if(1&i&&(c.Ub(0,"div",3),c.vc(1,x,12,7,"div",4),c.Tb()),2&i){const i=c.dc();c.Db(1),c.jc("ngForOf",i.materias)}}function y(i,t){if(1&i&&(c.Ub(0,"div",5),c.Ub(1,"div",15),c.Qb(2,"img",7),c.Ub(3,"div",8),c.Ub(4,"h5",9),c.wc(5),c.ec(6,"uppercase"),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&i){const i=t.$implicit;c.Db(2),c.kc("src",i.foto,c.rc),c.Db(3),c.xc(c.fc(6,2,i.correo))}}function E(i,t){1&i&&(c.Ub(0,"p"),c.wc(1,"No hay alumnos inscriptos."),c.Tb())}function T(i,t){if(1&i&&(c.Ub(0,"div",3),c.Ub(1,"span"),c.wc(2),c.Tb(),c.vc(3,y,7,4,"div",4),c.vc(4,E,2,0,"p",14),c.Tb()),2&i){const i=c.dc();c.Db(2),c.yc("Hay ",i.cupoDisponible," cupos disponibles."),c.Db(1),c.jc("ngForOf",i.alumnosParaMostrar),c.Db(1),c.jc("ngIf",0==i.alumnosParaMostrar.length)}}let P=(()=>{class i{constructor(i,t,n){this.matService=i,this.spinner=t,this.storage=n,this.materiaElegidaEvent=new c.n,this.paginaActual="inscripcion",this.loading=!0,this.mostrar=!1}ngOnInit(){this.spinner.show(),this.matService.traerTodos().snapshotChanges().forEach(i=>{this.materias=[],i.forEach(i=>{const t=i.payload.toJSON();t.uid=i.payload.key,t.estado==g.a.activo&&this.storage.traerFoto(t.foto).subscribe(i=>{t.foto=i,this.materias.push(t)})}),this.spinner.hide().then(()=>{this.loading=!1})}),this.matService.traerTodosIns().snapshotChanges().forEach(i=>{this.inscripciones=[],i.forEach(i=>{const t=i.payload.toJSON();t.uid=i.payload.key,this.inscripciones.push(t)})})}elegirMateria(i){this.elegida=i.nombre,this.materiaElegidaEvent.emit(i)}mostrarAlumnos(i){this.mostrar=!0,this.alumnosParaMostrar=[];let t=0;this.inscripciones.forEach(n=>{if(n&&n.nombre==i.nombre){this.cupoDisponible=n.cupoDisponible;for(let i=0;0==t;i++)n.alumnos[i]?this.alumnosParaMostrar.push(n.alumnos[i]):t=1}})}}return i.\u0275fac=function(t){return new(t||i)(c.Pb(b),c.Pb(d.c),c.Pb(f.a))},i.\u0275cmp=c.Jb({type:i,selectors:[["app-listado-materias"]],inputs:{paginaActual:["pagina","paginaActual"]},outputs:{materiaElegidaEvent:"materiaElegidaEvent"},decls:4,vars:2,consts:[["bdColor","rgba(51,51,51,0.8)","size","large","color","#fff","type","ball-scale-multiple"],[2,"font-size","20px","color","white"],["class","listado",4,"ngIf"],[1,"listado"],["class","fila",4,"ngFor","ngForOf"],[1,"fila"],[1,"card",2,"width","300","height","300","margin","10px"],["alt","Card image cap",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"btn","btn-dark",2,"margin","2px",3,"click"],["class","btn btn-danger","style","margin: 2px;",3,"click",4,"ngIf"],[1,"btn","btn-danger",2,"margin","2px",3,"click"],[4,"ngIf"],[1,"card",2,"width","300","height","250","margin","10px"]],template:function(i,t){1&i&&(c.Ub(0,"ngx-spinner",0),c.Qb(1,"p",1),c.Tb(),c.vc(2,w,2,1,"div",2),c.vc(3,T,5,3,"div",2)),2&i&&(c.Db(2),c.jc("ngIf",!t.loading),c.Db(1),c.jc("ngIf",!t.loading&&t.mostrar))},directives:[d.a,s.k,s.j],pipes:[s.q],styles:[".listado[_ngcontent-%COMP%]{overflow-x:scroll;border-radius:3px}.fila[_ngcontent-%COMP%], .listado[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:100%}.fila[_ngcontent-%COMP%]{padding:5px;justify-content:space-between}img[_ngcontent-%COMP%]{height:200px;width:300px}"]}),i})();var O=n("mRib");function D(i,t){if(1&i){const i=c.Vb();c.Ub(0,"div",2),c.Ub(1,"div",3),c.bc("click",function(){c.pc(i);const n=t.$implicit;return c.dc().elegirAlumno(n)}),c.Qb(2,"img",4),c.Ub(3,"div",5),c.Ub(4,"h5",6),c.wc(5),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&i){const i=t.$implicit;c.Db(2),c.kc("src",i.foto,c.rc),c.Db(3),c.xc(i.correo)}}let M=(()=>{class i{constructor(i,t,n){this.usService=i,this.spinner=t,this.storage=n,this.alumnoElegidoEvent=new c.n,this.loading=!0,this.mostrar=!1}ngOnInit(){this.spinner.show(),this.usService.traerTodos().snapshotChanges().forEach(i=>{this.alumnos=[],i.forEach(i=>{const t=i.payload.toJSON();t.estado==g.b.activo&&t.tipo==g.c.alumno&&this.storage.traerFoto(t.foto).subscribe(i=>{t.foto=i,this.alumnos.push(t)})}),this.spinner.hide().then(()=>{this.loading=!1})})}elegirAlumno(i){this.elegida=i.correo,this.alumnoElegidoEvent.emit(i)}}return i.\u0275fac=function(t){return new(t||i)(c.Pb(O.a),c.Pb(d.c),c.Pb(f.a))},i.\u0275cmp=c.Jb({type:i,selectors:[["app-listado-alumnos"]],outputs:{alumnoElegidoEvent:"alumnoElegidoEvent"},decls:2,vars:1,consts:[[1,"listado"],["class","fila",4,"ngFor","ngForOf"],[1,"fila"],[1,"card",2,"width","250","height","210","margin","10px",3,"click"],["alt","Card image cap",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"]],template:function(i,t){1&i&&(c.Ub(0,"div",0),c.vc(1,D,6,2,"div",1),c.Tb()),2&i&&(c.Db(1),c.jc("ngForOf",t.alumnos))},directives:[s.j],styles:[".listado[_ngcontent-%COMP%]{flex-direction:row;overflow-x:scroll;border-radius:3px}.fila[_ngcontent-%COMP%], .listado[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.fila[_ngcontent-%COMP%]{padding:5px;justify-content:space-between}img[_ngcontent-%COMP%]{height:170px;width:250px}.card[_ngcontent-%COMP%]{cursor:pointer}"]}),i})();var U=n("3Pt+");const k=[{path:"",component:(()=>{class i{constructor(i,t,n,s){this.auth=i,this.matService=t,this.spinner=n,this.router=s,this.alumno=null,this.materia=null}ngOnInit(){}salir(i){this.spinner.show(),this.auth.logOut().then(()=>{localStorage.removeItem("UsuarioActual"),this.spinner.hide().then(()=>{this.router.navigate(["/"])})})}asignarDatos(i,t){"materia"==t?(this.materia=i,this.nombre=this.materia.nombre):(this.alumno=i,this.correo=this.alumno.correo)}enviarDatos(){this.spinner.show(),null!=this.materia&&null!=this.alumno?(this.inscripcion=this.matService.traerPorNombreIns(this.materia.nombre),console.log("ESTO HAY ",this.inscripcion),null==this.inscripcion?(this.inscripcion=new o,this.inscripcion.cupo=this.materia.cupo,this.inscripcion.materia=this.materia,this.inscripcion.nombre=this.materia.nombre,this.inscripcion.cupoDisponible=this.materia.cupo-1,this.inscripcion.alumnos=this.inscripcion.alumnos||[],this.inscripcion.alumnos.push(this.alumno),this.matService.inscribirAlumno(this.inscripcion).subscribe(()=>{this.spinner.hide().then(()=>{a.a.fire({title:"Listo!",text:"Alumno inscripto!",icon:"success",confirmButtonText:"Ok"}).then(()=>{this.materia=null,this.alumno=null})})})):(console.log(this.inscripcion),0!=this.calcularDisponibilidad(this.inscripcion)?this.yaRegistrado(this.inscripcion)?this.spinner.hide().then(()=>{a.a.fire({title:"Error!",text:"Ya esta registrado en esta materia",icon:"error",confirmButtonColor:"red",confirmButtonText:"Ok"}).then(()=>{this.materia=null,this.alumno=null})}):(this.inscripcion.cupoDisponible=this.inscripcion.cupoDisponible-1,this.inscripcion.alumnos=this.calcularArray(this.inscripcion),this.inscripcion.alumnos.push(this.alumno),this.matService.sobrescribir(this.inscripcion).subscribe(()=>{this.spinner.hide().then(()=>{a.a.fire({title:"Listo!",text:"Alumno inscripto!",icon:"success",confirmButtonText:"Ok"}).then(()=>{this.materia=null,this.alumno=null})})})):this.spinner.hide().then(()=>{a.a.fire({title:"Error!",text:"No hay mas cupo disponible",icon:"error",confirmButtonColor:"red",confirmButtonText:"Ok"}).then(()=>{this.materia=null,this.alumno=null})}))):this.spinner.hide().then(()=>{a.a.fire({title:"Error!",text:"Tenes que seleccionar una materia y un alumno",icon:"error",confirmButtonColor:"red",confirmButtonText:"Ok"}).then(()=>{this.materia=null,this.alumno=null})})}calcularDisponibilidad(i){return i.alumnos?i.cupo==i.alumnos.length?0:i.cupo-i.alumnos.length:i.cupo}yaRegistrado(i){let t,n=0;t=this.matService.traerPorNombreIns(i.nombre),console.log("INS",t);for(let s=0;0==n;s++)if(t.alumnos[s]){if(t.alumnos[s].correo==this.alumno.correo)return!0}else n=1;return!1}calcularArray(i){let t=[],n=0;for(let s=0;0==n;s++)i.alumnos[s]?t.push(i.alumnos[s]):n=1;return console.log(t),t}}return i.\u0275fac=function(t){return new(t||i)(c.Pb(l.a),c.Pb(b),c.Pb(d.c),c.Pb(e.b))},i.\u0275cmp=c.Jb({type:i,selectors:[["app-inscripciones"]],decls:11,vars:2,consts:[[3,"navigateEvent"],[1,"centrado"],[1,"formulario","animate__animated","animate__fadeIn"],[1,"listados"],[3,"materiaElegidaEvent"],[3,"alumnoElegidoEvent"],[1,"futer"],["type","text","disabled","","placeholder","Alumno elegido",3,"ngModel","ngModelChange"],["type","text","disabled","","placeholder","Materia elegida",3,"ngModel","ngModelChange"],[1,"btn","btn-dark",2,"width","200px",3,"click"]],template:function(i,t){1&i&&(c.Ub(0,"app-cabecera",0),c.bc("navigateEvent",function(i){return t.salir(i)}),c.Tb(),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Ub(3,"div",3),c.Ub(4,"app-listado-materias",4),c.bc("materiaElegidaEvent",function(i){return t.asignarDatos(i,"materia")}),c.Tb(),c.Ub(5,"app-listado-alumnos",5),c.bc("alumnoElegidoEvent",function(i){return t.asignarDatos(i,"alumno")}),c.Tb(),c.Tb(),c.Ub(6,"div",6),c.Ub(7,"input",7),c.bc("ngModelChange",function(i){return t.correo!=i}),c.Tb(),c.Ub(8,"input",8),c.bc("ngModelChange",function(i){return t.nombre!=i}),c.Tb(),c.Ub(9,"button",9),c.bc("click",function(){return t.enviarDatos()}),c.wc(10,"Aceptar"),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&i&&(c.Db(7),c.jc("ngModel",t.correo),c.Db(1),c.jc("ngModel",t.nombre))},directives:[m.a,P,M,U.a,U.g,U.j],styles:[".centrado[_ngcontent-%COMP%]{position:absolute;width:100%;height:92%;background-size:100% 100%;background-color:bisque;overflow-y:hidden;display:flex;align-items:center;justify-content:center}.formulario[_ngcontent-%COMP%]{width:1000px;max-height:900px;padding:20px;background-color:#fff;border-radius:10px;box-shadow:0 0 10px #000;border:none;display:flex;flex-direction:column}.futer[_ngcontent-%COMP%]{padding:15px;display:flex;flex-direction:row;align-items:center;justify-content:space-around}.listados[_ngcontent-%COMP%]{width:100%;height:100%}"]}),i})()}];let C=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.Nb({type:i}),i.\u0275inj=c.Mb({imports:[[e.c.forChild(k)],e.c]}),i})();var S=n("lSLK");let j=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.Nb({type:i}),i.\u0275inj=c.Mb({imports:[[s.c,C,S.a,U.e]]}),i})()}}]);